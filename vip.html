<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP –¥–æ—Å—Ç—É–ø | AJALI PETKAHO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .vip-card {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #ff2f8b;
        }

        .price-tag {
            font-size: 2.5em;
            color: #ff2f8b;
            margin: 15px 0;
        }

        .features-list {
            list-style: none;
            padding: 0;
        }

        .features-list li {
            padding: 10px;
            border-bottom: 1px solid #333;
        }

        .payment-buttons {
            display: grid;
            gap: 15px;
            margin-top: 30px;
        }

        .payment-btn {
            background: #ff2f8b;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: transform 0.3s;
        }

        .payment-btn:hover {
            transform: translateY(-3px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="vip-card">
            <h1>VIP –î–û–°–¢–£–ü</h1>
            <div class="price-tag">$9.99/–º–µ—Å</div>
            
            <ul class="features-list">
                <li>‚úì –ó–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª —Å —ç–∫—Å–∫–ª—é–∑–∏–≤–æ–º</li>
                <li>‚úì –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –≤–∏–¥–µ–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É</li>
                <li>‚úì –î–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É 18+</li>
                <li>‚úì –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç —Å –º–æ–¥–µ–ª—è–º–∏</li>
            </ul>

            <div class="payment-buttons">
                <button class="payment-btn" onclick="handlePayment('card')">
                    üí≥ –û–ø–ª–∞—Ç–∏—Ç—å –∫–∞—Ä—Ç–æ–π
                </button>
                
                <button class="payment-btn" onclick="handlePayment('crypto')">
                    ‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞
                </button>
                
                <button class="payment-btn" onclick="handleTelegramPayment()">
                    üì≤ –û–ø–ª–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Telegram
                </button>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        tg.expand();
        tg.enableClosingConfirmation();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
        async function handlePayment(method) {
            if(method === 'telegram') {
                handleTelegramPayment();
                return;
            }

            const paymentData = {
                method,
                amount: 9.99,
                currency: 'USD'
            };

            try {
                const response = await fetch('/api/create-payment', {
                    method: 'POST',
                    body: JSON.stringify(paymentData)
                });
                
                if(method === 'card') {
                    window.location.href = response.url;
                } else {
                    showCryptoAddress(response.address);
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞');
            }
        }

        // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Payments
        function handleTelegramPayment() {
            tg.sendData(JSON.stringify({
                method: "invoice",
                params: {
                    title: "VIP –¥–æ—Å—Ç—É–ø",
                    description: "–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ 1 –º–µ—Å—è—Ü",
                    currency: "USD",
                    prices: [{ label: "VIP", amount: "999" }],
                    payload: JSON.stringify({
                        userId: tg.initDataUnsafe.user?.id,
                        type: "vip_subscription"
                    })
                }
            }));
        }

        tg.onEvent('invoiceClosed', (event) => {
            if(event.status === 'paid') {
                grantVipAccess(tg.initDataUnsafe.user.id);
                tg.showAlert('‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!');
                tg.close();
            }
        });

        // –í—ã–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–∞
        async function grantVipAccess(userId) {
            try {
                await fetch(`/api/grant-access?userId=${userId}`);
                localStorage.setItem('vipStatus', 'active');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã–¥–∞—á–∏ –¥–æ—Å—Ç—É–ø–∞:', error);
            }
        }
    </script>
</body>
</html>

